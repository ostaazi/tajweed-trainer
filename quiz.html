<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>التجويد - الاختبار</title>
  <style>
    :root{ --ink:#0f172a; --muted:#64748b; --ring:#e2e8f0; --violet:#7B1FA2; }
    html,body{background:#fff;margin:0;padding:0;font-family: system-ui, -apple-system, Segoe UI, Roboto, 'Noto Naskh Arabic', 'Amiri', serif;color:var(--ink)}
    .wrap{max-width:980px;margin:24px auto;padding:16px}
    h1{margin:0 0 12px 0;font-size:22px}
    .muted{color:var(--muted)}
    .btn{padding:10px 16px;border-radius:10px;border:1px solid var(--ring);background:#111;color:#fff;cursor:pointer}
    .btn.secondary{background:#4F46E5} .btn.info{background:#0ea5e9}
    #list .q h4{margin:0 0 8px 0}
    #list label{display:block;border:1px solid var(--ring);border-radius:10px;padding:8px 10px;margin:6px 0;cursor:pointer}

    .ayah{ font-family:'KFGQPC Uthman Taha Naskh','Noto Naskh Arabic',serif; font-size:1.5rem; line-height:2.3rem; text-align:center; }
    .target-word{ color: var(--violet); font-weight:700; background:rgba(123,31,162,.08); border-radius:4px; padding:0 3px; }

    .swatch{width:12px;height:12px;border-radius:3px;display:inline-block}
    .swatch-noon{ background: linear-gradient(to bottom, #d8ecff, #b5dcff); }
    .swatch-meem{ background: linear-gradient(to bottom, #f1d8ff, #e3b5ff); }
    .swatch-madd{ background: linear-gradient(to bottom, #fff2dc, #ffe2b5); }

    #triBar{position:relative;width:100%;height:26px;border-radius:999px;outline:1px solid var(--ring);user-select:none;margin-top:6px}
    #triBar .seg{position:absolute;inset-block:0;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:12px;color:#3b3b3b}
    #triBar .seg-noon{background:linear-gradient(to bottom,#e9f5ff,#cfe8ff)}
    #triBar .seg-meem{background:linear-gradient(to bottom,#f5e4ff,#e8c8ff)}
    #triBar .seg-madd{background:linear-gradient(to bottom,#fff6e8,#ffe8c6)}
    #triBar .pct{pointer-events:none}
    #triBar .handle{position:absolute;top:-6px;width:14px;height:38px;border-radius:6px;background:#0ea5e9;cursor:ew-resize;box-shadow:0 0 0 2px #fff}
    #triBar .handle:focus{outline:2px solid #0ea5e9}
    .triHelp{color:var(--muted);font-size:12px;margin:6px 2px 10px}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>إعداد الاختبار</h1>

    <!-- القسم + زر الاختبار القصير -->
    <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-bottom:12px">
      <select id="sectionSelect">
        <option value="noon">النون الساكنة والتنوين</option>
        <option value="meem">الميم الساكنة</option>
        <option value="madd">أحكام المدود</option>
      </select>
      <button id="btnShort" class="btn">بدء اختبار قصير (٥ أسئلة للقسم المحدد)</button>
    </div>

    <!-- منزلق عدد الأسئلة الكلي -->
    <div id="controls" class="muted" style="margin-bottom:10px">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:8px;flex-wrap:wrap">
        <label for="totalRange" style="font-weight:600">حدِّد عدد أسئلة الاختبار</label>
        <span><strong id="sumTarget">20</strong></span>
      </div>
      <input id="totalRange" type="range" min="5" max="100" step="1" value="20" style="width:100%">
      <input id="totalQ" type="hidden" value="20">
    </div>

    <!-- أسطورة الألوان بالترتيب الصحيح -->
    <div id="triLegend" style="display:flex;gap:12px;align-items:center;margin:10px 0 6px">
      <div style="display:flex;align-items:center;gap:6px"><span class="swatch swatch-noon"></span><span>النون الساكنة والتنوين</span></div>
      <div style="display:flex;align-items:center;gap:6px"><span class="swatch swatch-meem"></span><span>الميم الساكنة</span></div>
      <div style="display:flex;align-items:center;gap:6px"><span class="swatch swatch-madd"></span><span>أحكام المدود</span></div>
    </div>

    <!-- المنزلق الثلاثي بالنِّسب/الأعداد -->
    <div id="triWrap">
      <div id="triBar" aria-label="توزيع الإجمالي على الأقسام" title="اسحب الفواصل لتعديل النِّسب" dir="ltr">
        <div class="seg seg-noon"><span class="pct" id="pctNoon">33%</span></div>
        <div class="seg seg-meem"><span class="pct" id="pctMeem">33%</span></div>
        <div class="seg seg-madd"><span class="pct" id="pctMadd">34%</span></div>
        <div class="handle" id="h1" role="slider" aria-valuemin="0" aria-valuemax="100" aria-valuenow="33" aria-label="فاصل 1"></div>
        <div class="handle" id="h2" role="slider" aria-valuemin="0" aria-valuemax="100" aria-valuenow="66" aria-label="فاصل 2"></div>
      </div>
      <div class="triHelp">انقر أو اسحب الفواصل لتبديل العرض بين % وعدد الأسئلة.</div>
    </div>

    <!-- أزرار البدء والتصحيح -->
    <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin:12px 0">
      <button id="btnComprehensive" class="btn secondary">بدء اختبار شامل</button>
      <button id="btnGrade" class="btn info">تصحيح</button>
      <span id="diag" class="muted"></span>
    </div>

    <!-- ورقة الأسئلة + النتيجة -->
    <div id="list"></div>
    <div id="result" class="muted" style="margin-top:12px"></div>
  </div>

  <script src="quiz.js"></script>
</body>
</html>
